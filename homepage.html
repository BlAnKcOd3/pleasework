<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>De Anza Marketplace</title>
    <!-- Load FontAwesome for Icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <style>
        /* --- CSS START --- */
        
        /* General Page Reset */
        body {
            margin: 0;
            padding: 0;
            background-color: #f0ce55; /* Gold/Mustard background (Matches De Anza colors) */
            font-family: Arial, Helvetica, sans-serif;
            display: flex;
            flex-direction: column;
            min-height: 100vh;
        }

        /* Header Section */
        header {
            background-color: #4f090c; /* Dark Red (Matches De Anza colors) */
            padding: 15px 20px;
            display: flex;
            justify-content: center;
            align-items: center;
            position: relative;
            height: 80px;
            box-sizing: border-box;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }

        h1 {
            color: white;
            font-size: 3rem;
            margin: 0;
            font-weight: bold;
            text-align: center;
            /* Ensures the text is readable even with the icon */
            padding: 0 10px; 
        }

        /* Profile Icon Style */
        .header-icon {
            position: absolute;
            right: 20px;
            color: #3b82f6; /* Light blue color for visual distinction */
            font-size: 3rem;
            cursor: pointer;
            background-color: white;
            border-radius: 50%;
            width: 50px;
            height: 50px;
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: 0 0 5px rgba(0,0,0,0.2);
            transition: transform 0.2s;
        }

        .header-icon:hover {
            transform: scale(1.05);
        }

        /* Main Content Container */
        .container {
            width: 100%;
            max-width: 1000px;
            margin: 0 auto;
            padding: 20px;
            flex: 1;
        }

        /* Action Bar (Sell/Buy Buttons + Search) */
        .action-bar {
            display: flex;
            justify-content: center;
            align-items: center;
            position: relative;
            margin-bottom: 30px;
            margin-top: 10px;
            gap: 20px;
            flex-wrap: wrap; /* Allows wrapping on small screens */
        }

        .btn-pill {
            background-color: white;
            border: 3px solid black;
            border-radius: 20px; /* Pill shape */
            padding: 5px 0;
            width: 200px;
            text-align: center;
            font-size: 2rem;
            font-weight: bold;
            color: black;
            cursor: pointer;
            box-shadow: 2px 2px 5px rgba(0,0,0,0.1);
            transition: background-color 0.15s, transform 0.15s;
        }

        .btn-pill:hover {
            background-color: #ffed9a; /* Lighten on hover */
            transform: translateY(-2px);
        }
        
        .btn-pill:active {
            transform: translateY(0);
        }

        /* Search Container */
        .search-container {
            display: flex;
            align-items: center;
        }

        /* Hidden Search Input */
        #search-input {
            display: none;
            font-size: 1.5rem;
            padding: 5px 10px;
            border: 3px solid black;
            border-radius: 15px;
            width: 200px;
            margin-left: 10px;
            outline: none;
            transition: width 0.3s ease-in-out;
        }

        /* Search Icon Style */
        .search-icon {
            font-size: 3rem;
            color: black;
            margin-left: 20px;
            cursor: pointer;
            transition: color 0.2s;
        }
        
        .search-icon:hover {
            color: #4f090c;
        }

        /* Grid Layout for Categories */
        .category-grid {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 20px;
            padding-bottom: 40px;
        }

        .category-item {
            display: flex;
            flex-direction: column;
            align-items: center;
            text-align: center;
            cursor: pointer;
        }

        /* White Box for Icons */
        .icon-box {
            background-color: white;
            border: 3px solid black;
            border-radius: 25px;
            width: 100%;
            aspect-ratio: 1 / 1;
            display: flex;
            justify-content: center;
            align-items: center;
            margin-bottom: 10px;
            box-shadow: 3px 3px 6px rgba(0,0,0,0.2);
            transition: transform 0.2s, box-shadow 0.2s;
        }
        
        .icon-box:hover {
            transform: scale(1.05);
            box-shadow: 5px 5px 10px rgba(0,0,0,0.3);
        }

        /* Styles for the FontAwesome Icons inside the boxes */
        .icon-box i {
            font-size: 5rem; /* Make icons large */
        }

        /* Specific Colors for Icons to match the theme */
        .color-red { color: #8B0000; } /* Dark Red */
        .color-gold { color: #DAA520; } /* Goldenrod */
        .color-brown { color: #654321; } /* Dark Brown */

        .category-label {
            font-weight: bold;
            font-size: 1.1rem;
            color: #000;
            line-height: 1.2;
        }

        footer {
            background-color: #4f090c;
            height: 40px;
            width: 100%;
            margin-top: auto; /* Pushes footer to the bottom */
        }

        /* Responsive Adjustments */
        @media (max-width: 768px) {
            h1 { font-size: 2rem; }
            .category-grid { grid-template-columns: repeat(2, 1fr); }
            .action-bar { flex-direction: column; gap: 10px; }
            /* Reposition search container for mobile layout */
            .search-container { order: -1; margin-bottom: 10px; }
            .search-icon { margin-left: 0; }
            #search-input { width: calc(100vw - 100px); } /* Full width on mobile minus padding */
            .header-icon { width: 40px; height: 40px; font-size: 2.5rem; right: 10px; }
        }
        
        @media (max-width: 480px) {
            .btn-pill { width: 100%; }
        }
        
        /* --- CSS END --- */
    </style>
    <!-- Firebase SDK Imports -->
    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-app.js";
        import { getAuth, signInAnonymously, signInWithCustomToken, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-auth.js";
        
        // --- Firebase Configuration and Initialization ---
        const appId = typeof __app_id !== 'undefined' ? __app_id : 'default-app-id';
        const firebaseConfig = typeof __firebase_config !== 'undefined' ? JSON.parse(__firebase_config) : null;
        const initialAuthToken = typeof __initial_auth_token !== 'undefined' ? __initial_auth_token : null;

        if (!firebaseConfig) {
            console.error("Firebase configuration is missing. Cannot initialize app.");
        }
        
        const app = initializeApp(firebaseConfig);
        const auth = getAuth(app);

        const userIcon = document.getElementById('userIcon');

        // Initial sign-in for Canvas environment
        if (initialAuthToken) {
            signInWithCustomToken(auth, initialAuthToken).catch(e => {
                console.error("Custom Auth Token Sign-In failed:", e);
                signInAnonymously(auth).catch(e => {
                    console.error("Anonymous Sign-In failed:", e);
                });
            });
        } else {
            signInAnonymously(auth).catch(e => {
                console.error("Anonymous Sign-In failed:", e);
            });
        }

        // Handle user icon click
        userIcon.addEventListener('click', () => {
             // Use onAuthStateChanged to check if the user is currently signed in
             onAuthStateChanged(auth, (user) => {
                if (user && user.email) {
                    // User is signed in, redirect to dashboard/account management
                    window.location.href = 'dashboard.html';
                } else {
                    // User is not signed in, redirect to the login page
                    window.location.href = 'login.html';
                }
            }, { once: true }); // Use { once: true } to prevent continuous observation
        });
        
    </script>
</head>
<body>

    <!-- HEADER -->
    <header>
        <h1>De Anza Marketplace</h1>
        <!-- Account Icon (Using FontAwesome) -->
        <!-- Added id="userIcon" for JavaScript listener -->
        <div class="header-icon" id="userIcon">
            <i class="fas fa-user-circle"></i>
        </div>
    </header>

    <div class="container">
        
        <!-- ACTION BAR -->
        <div class="action-bar">
            <div class="btn-pill" onclick="console.log('Sell clicked');">Sell</div>
            <div class="btn-pill" onclick="console.log('Buy clicked');">Buy</div>
            
            <!-- Search Section -->
            <div class="search-container">
                <input type="text" id="search-input" placeholder="Search items...">
                <!-- Search Loop Icon -->
                <i class="fas fa-search search-icon" onclick="toggleSearch()"></i>
            </div>
        </div>

        <!-- GRID CATEGORIES -->
        <div class="category-grid">
            
            <!-- Item 1: Textbooks -->
            <div class="category-item" onclick="console.log('Textbooks clicked');">
                <div class="icon-box">
                    <i class="fas fa-book color-red"></i>
                </div>
                <div class="category-label">Textbooks</div>
            </div>

            <!-- Item 2: Supplies -->
            <div class="category-item" onclick="console.log('Study Supplies clicked');">
                <div class="icon-box">
                    <i class="fas fa-pencil-ruler color-gold"></i>
                </div>
                <div class="category-label">Study Supplies</div>
            </div>

            <!-- Item 3: Electronics -->
            <div class="category-item" onclick="console.log('Electronics clicked');">
                <div class="icon-box">
                    <i class="fas fa-laptop color-red"></i>
                </div>
                <div class="category-label">Electronics</div>
            </div>

            <!-- Item 4: Bikes -->
            <div class="category-item" onclick="console.log('Bikes & Outdoors clicked');">
                <div class="icon-box">
                    <i class="fas fa-motorcycle color-red"></i>
                </div>
                <div class="category-label">Bikes & Outdoors</div>
            </div>

            <!-- Item 5: Housing -->
            <div class="category-item" onclick="console.log('Housing & Roommates clicked');">
                <div class="icon-box">
                    <i class="fas fa-home color-brown"></i>
                </div>
                <div class="category-label">Housing<br>& Roommates</div>
            </div>

            <!-- Item 6: Services -->
            <div class="category-item" onclick="console.log('Services & Rentals clicked');">
                <div class="icon-box">
                    <i class="fas fa-tools color-red"></i>
                </div>
                <div class="category-label">Services<br>& Rentals</div>
            </div>

            <!-- Item 7: Jobs -->
            <div class="category-item" onclick="console.log('Student Jobs clicked');">
                <div class="icon-box">
                    <i class="fas fa-briefcase color-brown"></i>
                </div>
                <div class="category-label">Student<br>Jobs</div>
            </div>

            <!-- Item 8: Events -->
            <div class="category-item" onclick="console.log('Events clicked');">
                <div class="icon-box">
                    <i class="fas fa-bell color-gold"></i>
                </div>
                <div class="category-label">Events &<br>Campus Activities</div>
            </div>

        </div>
    </div>

    <!-- FOOTER -->
    <footer></footer>

    <script>
        // Function to toggle visibility of the search input field
        function toggleSearch() {
            var searchInput = document.getElementById("search-input");
            
            if (searchInput.style.display === "block") {
                searchInput.style.display = "none";
            } else {
                searchInput.style.display = "block";
                searchInput.focus();
            }
        }
    </script>

</body>
</html>